# üìö Library REST API  
**–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ1 ¬´–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è REST API¬ª**

---

## –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

–ó–∞–∫—Ä–µ–ø–∏—Ç—å –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è REST API:

- –ø—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å;
- —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤;
- –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å API;
- –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π;
- –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (rate limiting);
- –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –≤ —Ñ–æ—Ä–º–∞—Ç–µ OpenAPI (Swagger).

---

## 1. –ü—Ä–µ–¥–º–µ—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å

–ü—Ä–µ–¥–º–µ—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å ‚Äî **—Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π**.

### –°—É—â–Ω–æ—Å—Ç–∏ –∏ —Å–≤—è–∑–∏

#### User (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

- `id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä;
- `email` ‚Äî –ª–æ–≥–∏–Ω, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π;
- `password_hash` ‚Äî —Ö—ç—à –ø–∞—Ä–æ–ª—è;
- `created_at` ‚Äî –¥–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.

#### Book (–∫–Ω–∏–≥–∞)

- `id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–Ω–∏–≥–∏;
- `title` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ;
- `author` ‚Äî –∞–≤—Ç–æ—Ä;
- `isbn` ‚Äî ISBN;
- `published_year` ‚Äî –≥–æ–¥ –∏–∑–¥–∞–Ω–∏—è;
- `is_available` ‚Äî –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–Ω–∏–≥–∏;
- `genre` ‚Äî –∂–∞–Ω—Ä (–¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ v2 API);
- `pages` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü (–¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ v2 API).

#### Loan (–≤—ã–¥–∞—á–∞ –∫–Ω–∏–≥–∏)

- `id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤—ã–¥–∞—á–∏;
- `book_id` ‚Äî –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –Ω–∞ `books.id`;
- `user_id` ‚Äî –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –Ω–∞ `users.id`;
- `loan_date` ‚Äî –¥–∞—Ç–∞ –≤—ã–¥–∞—á–∏;
- `return_date` ‚Äî –¥–∞—Ç–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

### –°–≤—è–∑–∏

- –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—ã–¥–∞—á (User ‚Üí Loan, —Å–≤—è–∑—å 1:N)
- –û–¥–Ω–∞ –∫–Ω–∏–≥–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–¥–∞–Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è (Book ‚Üí Loan, —Å–≤—è–∑—å 1:N)

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Entity Framework Core (InMemory Database)**.

---

## 2. –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API (—Ä–µ—Å—É—Ä—Å—ã –∏ –∫–æ–Ω–µ—á–Ω—ã–µ —Ç–æ—á–∫–∏)

### –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ URL

- /api/v{version}/{resource}


### –†–µ—Å—É—Ä—Å—ã

- `auth` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π;
- `books` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥–∞–º–∏;
- `loans` ‚Äî –≤—ã–¥–∞—á–∞ –∏ –≤–æ–∑–≤—Ä–∞—Ç –∫–Ω–∏–≥.

### –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ (v1)

#### Auth v1

- `POST /api/v1/auth/register` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/v1/auth/login` ‚Äî –≤—Ö–æ–¥ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT-—Ç–æ–∫–µ–Ω–∞

#### Books v1

- `GET /api/v1/books` ‚Äî —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥
- `GET /api/v1/books/{id}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∫–Ω–∏–≥—É –ø–æ id
- `POST /api/v1/books` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É
- `PUT /api/v1/books/{id}` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –∫–Ω–∏–≥—É
- `DELETE /api/v1/books/{id}` ‚Äî —É–¥–∞–ª–∏—Ç—å –∫–Ω–∏–≥—É

#### Loans v1

- `POST /api/v1/loans` ‚Äî –≤—ã–¥–∞—Ç—å –∫–Ω–∏–≥—É
- `POST /api/v1/loans/{id}/return` ‚Äî –≤–µ—Ä–Ω—É—Ç—å –∫–Ω–∏–≥—É
- `GET /api/v1/loans/my` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—ã–¥–∞—á —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

API –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ REST-–ø—Ä–∏–Ω—Ü–∏–ø–∞–º:  
—Ä–µ—Å—É—Ä—Å—ã –≤–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —á–∏—Å–ª–µ, –¥–µ–π—Å—Ç–≤–∏—è –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è HTTP-–º–µ—Ç–æ–¥–∞–º–∏ (GET, POST, PUT, DELETE).

---

## 3. –í–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å –∏ –∞–¥–¥–∏—Ç–∏–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ **URL-based –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API**.

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏

- **v1** ‚Äî –±–∞–∑–æ–≤–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è API
- **v2** ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è API

### –û—Ç–ª–∏—á–∏—è v2 (–∞–¥–¥–∏—Ç–∏–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è)

#### Books v2

- `GET /api/v2/books` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–Ω–∏–≥–∏ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏:
  - `genre`
  - `pages`

–í –≤–µ—Ä—Å–∏–∏ v1 –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ.  
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –±–µ–∑ –Ω–∞—Ä—É—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.

### –õ–æ–º–∞—é—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

–ö –ª–æ–º–∞—é—â–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –æ—Ç–Ω–æ—Å—è—Ç—Å—è:

- —É–¥–∞–ª–µ–Ω–∏–µ –∏–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π;
- –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö;
- –∏–∑–º–µ–Ω–µ–Ω–∏–µ URL —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤.

–¢–∞–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å ‚Äî –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è API.

---

## 4. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (JWT)

–î–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **JWT (JSON Web Token)** —Å–æ —Å—Ö–µ–º–æ–π `Bearer`.

### –ü—Ä–∏—á–∏–Ω—ã –≤—ã–±–æ—Ä–∞ JWT

- Stateless-–ø–æ–¥—Ö–æ–¥;
- –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è REST API;
- –ø—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è;
- –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è.

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:
- POST /api/v1/auth/login
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:
- Authorization: Bearer <JWT>

---

## 5. –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤:

- `POST /api/v1/loans`
- `POST /api/v2/loans`

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫

- Idempotency-Key: <—É–Ω–∏–∫–∞–ª—å–Ω—ã–π_–∫–ª—é—á>

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ

- –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å —Å–æ–∑–¥–∞—ë—Ç —Ä–µ—Å—É—Ä—Å;
- –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å —Ç–µ–º –∂–µ –∫–ª—é—á–æ–º –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –¥—É–±–ª–∏–∫–∞—Ç;
- –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ä–∞–Ω–µ–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

---

## 6. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (Rate Limiting)

–î–ª—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –≤–∫–ª—é—á–µ–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤.

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

- 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
- –∞–ª–≥–æ—Ä–∏—Ç–º Token Bucket.

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ

- —Å—Ç–∞—Ç—É—Å `429 Too Many Requests`;
- –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Retry-After`.

---

## 7. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (OpenAPI / Swagger)

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Swagger.

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∞–¥—Ä–µ—Å–∞

- Swagger UI:
  /swagger
- OpenAPI JSON:
  /swagger/v1/swagger.json
  /swagger/v2/swagger.json

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –≤–µ—Ä—Å–∏–∏ API, —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, —Å—Ö–µ–º—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤, –∞ —Ç–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∫—É JWT.

---

## 8. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- .NET SDK 8.0+

### –ó–∞–ø—É—Å–∫

```bash
dotnet restore
dotnet run
